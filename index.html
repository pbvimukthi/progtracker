<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Progress Tracker</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root {
  --primary: #6366f1;
  --primary-dark: #4f46e5;
  --secondary: #8b5cf6;
  --accent: #06b6d4;
  --success: #10b981;
  --warning: #f59e0b;
  --danger: #ef4444;
  --dark: #0f172a;
  --darker: #0a0f1c;
  --light: #f8fafc;
  --gray: #94a3b8;
  --card-bg: rgba(30, 41, 59, 0.9);
  --card-border: rgba(148, 163, 184, 0.1);
  --card-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
  --lessons-color: #10b981;
  --assignments-color: #f59e0b;
  --complete-color: #22c55e;
  --complete-glow: rgba(34, 197, 94, 0.3);
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: 'Inter', system-ui, -apple-system, sans-serif;
}

html {
  height: 100%;
  background: linear-gradient(145deg, var(--darker) 0%, #1e1b4b 100%);
  background-attachment: fixed;
}

body {
  background: linear-gradient(145deg, var(--darker) 0%, #1e1b4b 100%);
  color: var(--light);
  min-height: 100vh;
  padding: 20px;
  background-attachment: fixed;
}

.container {
  max-width: 1400px;
  margin: 0 auto;
}

header {
  text-align: center;
  margin-bottom: 40px;
  padding: 30px;
  background: rgba(30, 41, 59, 0.7);
  border-radius: 24px;
  backdrop-filter: blur(20px);
  border: 1px solid var(--card-border);
  box-shadow: var(--card-shadow);
  position: relative;
  overflow: hidden;
}

header::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, var(--primary), var(--accent));
}

h1 {
  font-size: 3rem;
  margin-bottom: 10px;
  background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  display: inline-block;
  font-weight: 800;
  letter-spacing: -0.5px;
}

.subtitle {
  color: var(--gray);
  font-size: 1.2rem;
  margin-bottom: 25px;
  max-width: 600px;
  margin-left: auto;
  margin-right: auto;
  line-height: 1.6;
}

.controls {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin-top: 30px;
  flex-wrap: wrap;
}

.btn {
  padding: 14px 28px;
  border: none;
  border-radius: 12px;
  font-weight: 600;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  gap: 10px;
  transition: all 0.3s ease;
  font-size: 1rem;
  letter-spacing: 0.3px;
  position: relative;
  overflow: hidden;
}

.btn::after {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
  transition: left 0.6s;
}

.btn:hover::after {
  left: 100%;
}

.btn-primary {
  background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
  color: white;
  box-shadow: 0 8px 25px rgba(99, 102, 241, 0.3);
}

.btn-primary:hover {
  transform: translateY(-5px);
  box-shadow: 0 15px 35px rgba(99, 102, 241, 0.4);
}

.btn-success {
  background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
  color: white;
  box-shadow: 0 8px 25px rgba(16, 185, 129, 0.3);
}

.btn-success:hover {
  transform: translateY(-5px);
  box-shadow: 0 15px 35px rgba(16, 185, 129, 0.4);
}

.btn-secondary {
  background: rgba(255, 255, 255, 0.1);
  color: var(--light);
  border: 1px solid rgba(255, 255, 255, 0.15);
  backdrop-filter: blur(10px);
}

.btn-secondary:hover {
  background: rgba(255, 255, 255, 0.15);
  transform: translateY(-5px);
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
}

.btn-back {
  background: transparent;
  color: var(--gray);
  border: 1px solid rgba(255, 255, 255, 0.15);
}

.btn-back:hover {
  background: rgba(255, 255, 255, 0.1);
  color: white;
}

/* Card View */
.cards-container {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
  gap: 30px;
  margin-bottom: 40px;
}

.module-card {
  background: var(--card-bg);
  border-radius: 20px;
  padding: 30px;
  border: 1px solid var(--card-border);
  transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  cursor: pointer;
  position: relative;
  overflow: hidden;
  backdrop-filter: blur(10px);
}

.module-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 5px;
  background: linear-gradient(90deg, var(--primary), var(--accent));
  opacity: 0;
  transition: opacity 0.3s ease;
}

.module-card:hover::before {
  opacity: 1;
}

.module-card:hover {
  transform: translateY(-10px) scale(1.02);
  box-shadow: var(--card-shadow);
  border-color: rgba(99, 102, 241, 0.3);
}

.module-card.completed {
  border-color: var(--complete-color);
  box-shadow: 0 0 40px var(--complete-glow);
}

/* Fixed Completed Banner - Now in front */
.completed-banner {
  position: absolute;
  top: 20px;
  right: -40px;
  background: linear-gradient(135deg, var(--complete-color) 0%, #16a34a 100%);
  color: white;
  padding: 12px 50px;
  font-size: 1rem;
  font-weight: 700;
  transform: rotate(45deg);
  box-shadow: 0 5px 20px rgba(34, 197, 94, 0.4);
  display: flex;
  align-items: center;
  gap: 8px;
  z-index: 10; /* Higher z-index to be in front */
  pointer-events: none; /* Allow clicks to pass through */
}

.completed-banner i {
  font-size: 1.1rem;
}

.card-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 25px;
  position: relative;
  z-index: 2; /* Lower than banner */
}

.card-title {
  font-size: 1.5rem;
  font-weight: 700;
  color: white;
  display: flex;
  align-items: center;
  gap: 12px;
  flex: 1;
  min-width: 0;
}

.card-title-text {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.card-title i {
  color: var(--primary);
  flex-shrink: 0;
}

.card-actions {
  display: flex;
  gap: 8px;
  z-index: 3;
  position: relative;
}

/* Hide edit and delete buttons when module is completed */
.module-card.completed .icon-btn:not(.retry-btn) {
  display: none;
}

/* Show only retry button for completed modules */
.retry-btn {
  background: linear-gradient(135deg, var(--warning) 0%, #d97706 100%);
  border-color: var(--warning);
  color: white;
}

.retry-btn:hover {
  background: linear-gradient(135deg, #d97706 0%, #b45309 100%);
  transform: translateY(-2px);
  box-shadow: 0 5px 20px rgba(245, 158, 11, 0.3);
}

.icon-btn {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.15);
  color: var(--gray);
  width: 40px;
  height: 40px;
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  flex-shrink: 0;
}

.icon-btn:hover {
  background: rgba(255, 255, 255, 0.2);
  color: white;
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
}

.card-progress {
  margin-bottom: 25px;
}

.card-progress-item {
  margin-bottom: 15px;
}

.card-progress-label {
  display: flex;
  justify-content: space-between;
  margin-bottom: 8px;
  font-size: 0.9rem;
  color: var(--gray);
}

.card-progress-label span:first-child {
  display: flex;
  align-items: center;
  gap: 6px;
}

.card-progress-label span:last-child {
  font-weight: 600;
  color: white;
}

.progress-bar {
  height: 10px;
  background: rgba(255, 255, 255, 0.08);
  border-radius: 10px;
  overflow: hidden;
  position: relative;
}

.progress-bar::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.05), transparent);
  background-size: 200% 100%;
  animation: shimmer 2s infinite;
}

@keyframes shimmer {
  0% { background-position: -200% 0; }
  100% { background-position: 200% 0; }
}

.progress-fill {
  height: 100%;
  border-radius: 10px;
  transition: width 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
  position: relative;
  z-index: 1;
}

.progress-fill::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  border-radius: 10px;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
  background-size: 200% 100%;
  animation: shimmer 2s infinite;
}

.progress-fill.lessons {
  background: linear-gradient(90deg, var(--lessons-color), #34d399);
}

.progress-fill.assignments {
  background: linear-gradient(90deg, var(--assignments-color), #fbbf24);
}

.card-overall-progress {
  margin-top: 20px;
  padding-top: 20px;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.card-overall-progress .progress-fill {
  background: linear-gradient(90deg, var(--primary), var(--accent));
}

.card-stats {
  display: flex;
  justify-content: space-between;
  margin-top: 20px;
  padding-top: 20px;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  font-size: 0.9rem;
}

.stat {
  text-align: center;
  flex: 1;
}

.stat-value {
  font-size: 1.5rem;
  font-weight: 700;
  color: white;
  margin-bottom: 4px;
}

.stat-label {
  color: var(--gray);
  font-size: 0.85rem;
}

/* Detailed Module View */
.detailed-view {
  display: none;
  animation: fadeIn 0.5s ease;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

.module-detailed {
  background: var(--card-bg);
  border-radius: 24px;
  padding: 40px;
  border: 1px solid var(--card-border);
  margin-bottom: 40px;
  position: relative;
  backdrop-filter: blur(20px);
  box-shadow: var(--card-shadow);
  overflow: hidden;
}

.module-detailed::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 6px;
  background: linear-gradient(90deg, var(--primary), var(--accent));
}

.module-detailed.completed {
  border-color: var(--complete-color);
  box-shadow: 0 0 50px var(--complete-glow);
}

.detailed-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 40px;
  padding-bottom: 30px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  position: relative;
}

.detailed-title {
  font-size: 2.5rem;
  font-weight: 800;
  color: white;
  display: flex;
  align-items: center;
  gap: 20px;
  flex: 1;
  min-width: 0;
}

.detailed-title i {
  color: var(--primary);
  flex-shrink: 0;
}

.detailed-title-text {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.detailed-actions {
  display: flex;
  gap: 12px;
  flex-shrink: 0;
}

.detailed-progress-section {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
  gap: 40px;
  margin-bottom: 50px;
}

.progress-chart {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 20px;
  padding: 30px;
  border: 1px solid rgba(255, 255, 255, 0.1);
  transition: transform 0.3s ease;
}

.progress-chart:hover {
  transform: translateY(-5px);
}

.chart-title {
  font-size: 1.4rem;
  margin-bottom: 25px;
  color: white;
  display: flex;
  align-items: center;
  gap: 12px;
}

.circular-progress {
  width: 200px;
  height: 200px;
  margin: 0 auto 25px;
  position: relative;
}

.circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 10;
}

.circle-progress {
  fill: none;
  stroke-width: 10;
  stroke-linecap: round;
  transform: rotate(-90deg);
  transform-origin: 50% 50%;
  transition: stroke-dashoffset 1s cubic-bezier(0.34, 1.56, 0.64, 1);
  filter: drop-shadow(0 5px 15px rgba(0,0,0,0.3));
}

.lessons-circle {
  stroke: url(#lessons-gradient);
}

.assignments-circle {
  stroke: url(#assignments-gradient);
}

.overall-circle {
  stroke: url(#overall-gradient);
}

.progress-percentage {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 3rem;
  font-weight: 800;
  color: white;
  text-shadow: 0 5px 15px rgba(0,0,0,0.3);
}

.progress-label-large {
  text-align: center;
  font-size: 1.2rem;
  color: var(--gray);
  margin-top: 15px;
}

.items-section {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
  gap: 40px;
}

.section-box {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 20px;
  padding: 30px;
  border: 1px solid rgba(255, 255, 255, 0.1);
  transition: transform 0.3s ease;
}

.section-box:hover {
  transform: translateY(-5px);
}

.section-title {
  font-size: 1.4rem;
  margin-bottom: 25px;
  color: white;
  display: flex;
  align-items: center;
  gap: 12px;
}

.add-item {
  display: flex;
  gap: 12px;
  margin-bottom: 25px;
}

.add-item input {
  flex-grow: 1;
  padding: 15px 20px;
  border-radius: 12px;
  border: 1px solid rgba(255, 255, 255, 0.15);
  background: rgba(255, 255, 255, 0.08);
  color: white;
  font-size: 1.05rem;
  transition: all 0.3s ease;
}

.add-item input:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
  background: rgba(255, 255, 255, 0.12);
}

.add-item button {
  padding: 0 24px;
  border-radius: 12px;
  border: none;
  background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
  color: white;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  white-space: nowrap;
}

.add-item button:hover {
  transform: translateY(-2px);
  box-shadow: 0 10px 25px rgba(99, 102, 241, 0.3);
}

.item-list {
  list-style: none;
  max-height: 450px;
  overflow-y: auto;
  padding-right: 5px;
}

.item-list li {
  padding: 18px;
  background: rgba(255, 255, 255, 0.08);
  border-radius: 12px;
  margin-bottom: 12px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  transition: all 0.3s ease;
  border-left: 4px solid transparent;
}

.item-list li:hover {
  background: rgba(255, 255, 255, 0.12);
  transform: translateX(5px);
}

.item-list li.completed {
  opacity: 0.8;
  border-left-color: var(--complete-color);
}

.item-list li.completed .item-text {
  text-decoration: line-through;
  color: var(--gray);
}

.item-list li.lesson-item {
  border-left-color: var(--lessons-color);
}

.item-list li.assignment-item {
  border-left-color: var(--assignments-color);
}

.item-text {
  flex-grow: 1;
  font-size: 1.1rem;
  color: white;
  cursor: pointer;
  padding: 5px 10px;
  border-radius: 6px;
  transition: background 0.2s ease;
}

.item-text:hover {
  background: rgba(255, 255, 255, 0.05);
}

.item-actions {
  display: flex;
  gap: 8px;
  opacity: 0;
  transition: opacity 0.2s ease;
}

.item-list li:hover .item-actions {
  opacity: 1;
}

.checkbox {
  width: 26px;
  height: 26px;
  border-radius: 8px;
  border: 2px solid rgba(255, 255, 255, 0.3);
  background: transparent;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-right: 15px;
  flex-shrink: 0;
  transition: all 0.2s ease;
}

.checkbox:hover {
  border-color: var(--complete-color);
  transform: scale(1.1);
}

.checkbox.checked {
  background: var(--complete-color);
  border-color: var(--complete-color);
  box-shadow: 0 5px 15px rgba(34, 197, 94, 0.3);
}

.checkbox.checked::after {
  content: "✓";
  color: white;
  font-size: 1rem;
  font-weight: bold;
}

.delete-btn, .edit-btn {
  background: transparent;
  border: none;
  cursor: pointer;
  font-size: 1.1rem;
  width: 36px;
  height: 36px;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
}

.delete-btn {
  color: var(--danger);
}

.delete-btn:hover {
  background: rgba(239, 68, 68, 0.15);
  transform: scale(1.1);
}

.edit-btn {
  color: var(--accent);
}

.edit-btn:hover {
  background: rgba(6, 182, 212, 0.15);
  transform: scale(1.1);
}

.item-info {
  display: flex;
  align-items: center;
  flex: 1;
  min-width: 0;
}

.item-text-content {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  flex: 1;
}

.empty-state {
  text-align: center;
  padding: 80px 20px;
  color: var(--gray);
}

.empty-state i {
  font-size: 5rem;
  margin-bottom: 25px;
  opacity: 0.5;
}

.empty-state h3 {
  font-size: 2rem;
  margin-bottom: 15px;
  color: white;
  font-weight: 700;
}

.empty-state p {
  font-size: 1.2rem;
  max-width: 500px;
  margin: 0 auto 30px;
  line-height: 1.6;
}

.modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s ease;
  backdrop-filter: blur(10px);
}

.modal.active {
  opacity: 1;
  visibility: visible;
}

.modal-content {
  background: var(--card-bg);
  border-radius: 24px;
  padding: 40px;
  width: 90%;
  max-width: 500px;
  border: 1px solid var(--card-border);
  transform: translateY(30px);
  transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  box-shadow: var(--card-shadow);
  backdrop-filter: blur(20px);
}

.modal.active .modal-content {
  transform: translateY(0);
}

.modal h3 {
  margin-bottom: 25px;
  font-size: 1.8rem;
  color: white;
  display: flex;
  align-items: center;
  gap: 12px;
}

.modal-input {
  width: 100%;
  padding: 18px 20px;
  border-radius: 12px;
  border: 1px solid rgba(255, 255, 255, 0.15);
  background: rgba(255, 255, 255, 0.08);
  color: white;
  font-size: 1.1rem;
  margin-bottom: 25px;
  transition: all 0.3s ease;
}

.modal-input:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
  background: rgba(255, 255, 255, 0.12);
}

.modal-actions {
  display: flex;
  justify-content: flex-end;
  gap: 15px;
}

.stats-bar {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 20px;
  padding: 25px;
  margin-bottom: 40px;
  border: 1px solid rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
}

.stat-item {
  text-align: center;
  padding: 15px;
  background: rgba(255, 255, 255, 0.08);
  border-radius: 16px;
  transition: transform 0.3s ease;
}

.stat-item:hover {
  transform: translateY(-5px);
  background: rgba(255, 255, 255, 0.12);
}

.stat-value {
  font-size: 2.8rem;
  font-weight: 800;
  background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  line-height: 1;
  margin-bottom: 8px;
}

.stat-label {
  color: var(--gray);
  font-size: 0.95rem;
  font-weight: 500;
}

footer {
  text-align: center;
  padding: 25px;
  color: var(--gray);
  font-size: 0.95rem;
  margin-top: 60px;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  background: rgba(255, 255, 255, 0.02);
  border-radius: 20px;
  backdrop-filter: blur(10px);
}

/* Scrollbar styling */
::-webkit-scrollbar {
  width: 10px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 10px;
}

::-webkit-scrollbar-thumb {
  background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
  border-radius: 10px;
}

::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(135deg, var(--primary-dark) 0%, var(--secondary) 100%);
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .cards-container {
    grid-template-columns: 1fr;
  }
  
  .detailed-progress-section,
  .items-section {
    grid-template-columns: 1fr;
  }
  
  .stats-bar {
    grid-template-columns: 1fr 1fr;
  }
  
  h1 {
    font-size: 2.2rem;
  }
  
  .controls {
    flex-direction: column;
    align-items: center;
  }
  
  .btn {
    width: 100%;
    justify-content: center;
  }
  
  .detailed-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 20px;
  }
  
  .detailed-actions {
    align-self: flex-end;
  }
  
  .detailed-title {
    font-size: 1.8rem;
  }
  
  .circular-progress {
    width: 160px;
    height: 160px;
  }
  
  .progress-percentage {
    font-size: 2.2rem;
  }
  
  .completed-banner {
    padding: 10px 40px;
    font-size: 0.9rem;
    right: -35px;
  }
}

/* Edit mode styling */
.editing {
  background: rgba(6, 182, 212, 0.1) !important;
  border: 2px solid var(--accent) !important;
}

.edit-input {
  width: 100%;
  padding: 10px 15px;
  border-radius: 8px;
  border: 2px solid var(--accent);
  background: rgba(255, 255, 255, 0.1);
  color: white;
  font-size: 1.1rem;
  font-weight: 500;
}

.edit-input:focus {
  outline: none;
  box-shadow: 0 0 0 3px rgba(6, 182, 212, 0.2);
}
</style>
</head>
<body>
<div class="container">
  <header>
    <h1><i class="fas fa-graduation-cap"></i>Progress Tracker</h1>
    <p class="subtitle">Created for me. By me :D</p>
    
    <div class="stats-bar">
      <div class="stat-item">
        <div class="stat-value" id="total-modules">0</div>
        <div class="stat-label">Total Modules</div>
      </div>
      <div class="stat-item">
        <div class="stat-value" id="completed-modules">0</div>
        <div class="stat-label">Completed Modules</div>
      </div>
      <div class="stat-item">
        <div class="stat-value" id="total-lessons">0</div>
        <div class="stat-label">Total Lessons</div>
      </div>
      <div class="stat-item">
        <div class="stat-value" id="completed-assignments">0</div>
        <div class="stat-label">Completed Assignments</div>
      </div>
    </div>
    
    <div class="controls">
      <button class="btn btn-primary" onclick="showAddModuleModal()">
        <i class="fas fa-plus-circle"></i> Add New Module
      </button>
      <button class="btn btn-secondary" onclick="clearAllData()">
        <i class="fas fa-trash-alt"></i> Clear All Data
      </button>
      <button class="btn btn-secondary" onclick="exportData()">
        <i class="fas fa-download"></i> Export Data
      </button>
    </div>
  </header>

  <!-- Card View -->
  <div id="card-view">
    <div class="cards-container" id="cards-container">
      <!-- Module cards will be dynamically inserted here -->
    </div>

    <div class="empty-state" id="empty-state">
      <i class="fas fa-book-open"></i>
      <h3>No modules yet</h3>
      <p>Add your first module to start tracking your semester progress. Click the button below to get started.</p>
      <button class="btn btn-primary" style="margin-top: 20px;" onclick="showAddModuleModal()">
        <i class="fas fa-plus-circle"></i> Add Your First Module
      </button>
    </div>
  </div>

  <!-- Detailed Module View -->
  <div class="detailed-view" id="detailed-view">
    <button class="btn btn-back" onclick="showCardView()">
      <i class="fas fa-arrow-left"></i> Back to All Modules
    </button>
    
    <div id="module-detailed-container">
      <!-- Detailed module view will be dynamically inserted here -->
    </div>
  </div>

  <!-- Add Module Modal -->
  <div class="modal" id="add-module-modal">
    <div class="modal-content">
      <h3><i class="fas fa-plus-circle"></i> Add New Module</h3>
      <input type="text" class="modal-input" id="new-module-name" placeholder="Enter module name (e.g., Advanced Algorithms)">
      <div class="modal-actions">
        <button class="btn btn-secondary" onclick="hideAddModuleModal()">Cancel</button>
        <button class="btn btn-primary" onclick="addNewModule()">Add Module</button>
      </div>
    </div>
  </div>

  <!-- Edit Module Name Modal -->
  <div class="modal" id="edit-module-modal">
    <div class="modal-content">
      <h3><i class="fas fa-edit"></i> Edit Module Name</h3>
      <input type="text" class="modal-input" id="edit-module-name" placeholder="Enter new module name">
      <div class="modal-actions">
        <button class="btn btn-secondary" onclick="hideEditModuleModal()">Cancel</button>
        <button class="btn btn-primary" onclick="saveModuleName()">Save Changes</button>
      </div>
    </div>
  </div>

  <!-- Edit Item Name Modal -->
  <div class="modal" id="edit-item-modal">
    <div class="modal-content">
      <h3><i class="fas fa-edit"></i> Edit Item</h3>
      <input type="text" class="modal-input" id="edit-item-name" placeholder="Enter new item name">
      <input type="hidden" id="edit-item-type">
      <input type="hidden" id="edit-item-id">
      <div class="modal-actions">
        <button class="btn btn-secondary" onclick="hideEditItemModal()">Cancel</button>
        <button class="btn btn-primary" onclick="saveItemName()">Save Changes</button>
      </div>
    </div>
  </div>

  <footer>
    <p>Nothing to see here. ;) </p>
  </footer>
</div>

<script>
// Initial modules data
const initialModules = [
  { 
    id: 1, 
    name: "Programming Fundamentals", 
    completed: false,
    lessons: [
      { id: 1, text: "Introduction to Java", completed: true },
      { id: 2, text: "Variables and Data Types", completed: true },
      { id: 3, text: "Control Structures", completed: true },
      { id: 4, text: "Object-Oriented Programming", completed: false },
      { id: 5, text: "Exception Handling", completed: false }
    ],
    assignments: [
      { id: 1, text: "Project 1: Calculator App", completed: true },
      { id: 2, text: "Assignment 2: Arrays", completed: true },
      { id: 3, text: "Assignment 3: Inheritance", completed: false }
    ]
  },
  { 
    id: 2, 
    name: "Calculus & Algebra", 
    completed: false,
    lessons: [
      { id: 1, text: "Limits and Continuity", completed: true },
      { id: 2, text: "Derivatives", completed: true },
      { id: 3, text: "Integration", completed: false },
      { id: 4, text: "Differential Equations", completed: false }
    ],
    assignments: [
      { id: 1, text: "Assignment 1: Limits", completed: true },
      { id: 2, text: "Group Project: Mathematical Modeling", completed: false }
    ]
  },
  { 
    id: 3, 
    name: "Digital Electronics", 
    completed: true,
    lessons: [
      { id: 1, text: "Logic Gates", completed: true },
      { id: 2, text: "Boolean Algebra", completed: true },
      { id: 3, text: "Combinational Circuits", completed: true },
      { id: 4, text: "Sequential Circuits", completed: true }
    ],
    assignments: [
      { id: 1, text: "Lab 4: Flip Flops", completed: true },
      { id: 2, text: "Final Project: Digital Clock", completed: true }
    ]
  }
];

// Load data from localStorage or use initial data
let modules = JSON.parse(localStorage.getItem('university-modules')) || initialModules;
let nextId = modules.length > 0 ? Math.max(...modules.map(m => m.id)) + 1 : 4;
let currentView = 'card'; // 'card' or 'detailed'
let currentModuleId = null;
let editingModuleId = null;
let editingItem = { type: null, id: null, moduleId: null };

// Initialize the app
function initApp() {
  renderCardView();
  updateStats();
}

// Render card view
function renderCardView() {
  const cardsContainer = document.getElementById('cards-container');
  const emptyState = document.getElementById('empty-state');
  const cardView = document.getElementById('card-view');
  const detailedView = document.getElementById('detailed-view');
  
  if (modules.length === 0) {
    cardsContainer.innerHTML = '';
    emptyState.style.display = 'block';
    cardView.style.display = 'block';
    detailedView.style.display = 'none';
    return;
  }
  
  emptyState.style.display = 'none';
  cardsContainer.innerHTML = '';
  cardView.style.display = 'block';
  detailedView.style.display = 'none';
  currentView = 'card';
  
  modules.forEach(module => {
    const cardElement = createCardElement(module);
    cardsContainer.appendChild(cardElement);
  });
}

// Create a card element
function createCardElement(module) {
  const lessonsProgress = calculateProgress(module.lessons);
  const assignmentsProgress = calculateProgress(module.assignments);
  const overallProgress = Math.round((lessonsProgress + assignmentsProgress) / 2);
  
  const cardElement = document.createElement('div');
  cardElement.className = `module-card ${module.completed ? 'completed' : ''}`;
  cardElement.setAttribute('data-module-id', module.id);
  cardElement.addEventListener('click', (e) => {
    // Don't open detailed view if clicking on action buttons
    if (!e.target.closest('.card-actions')) {
      showDetailedView(module.id);
    }
  });
  
  // Determine which buttons to show
  let actionButtons = '';
  if (module.completed) {
    // Only show retry button for completed modules
    actionButtons = `
      <button class="icon-btn retry-btn" onclick="toggleModuleCompletion(${module.id}, event)" title="Retry this module">
        <i class="fas fa-redo"></i>
      </button>
    `;
  } else {
    // Show all buttons for incomplete modules
    actionButtons = `
      <button class="icon-btn" onclick="startEditModuleName(${module.id}, '${module.name.replace(/'/g, "\\'")}')" title="Edit module name">
        <i class="fas fa-edit"></i>
      </button>
      <button class="icon-btn" onclick="toggleModuleCompletion(${module.id}, event)" title="Mark as complete">
        <i class="fas fa-check"></i>
      </button>
      <button class="icon-btn" onclick="deleteModule(${module.id}, event)" title="Delete module">
        <i class="fas fa-trash"></i>
      </button>
    `;
  }
  
  cardElement.innerHTML = `
    ${module.completed ? `
      <div class="completed-banner">
        <i class="fas fa-check"></i>
        COMPLETED
      </div>
    ` : ''}
    
    <div class="card-header">
      <div class="card-title">
        <i class="fas fa-book"></i>
        <div class="card-title-text" ondblclick="startEditModuleName(${module.id}, '${module.name.replace(/'/g, "\\'")}')">${module.name}</div>
      </div>
      <div class="card-actions">
        ${actionButtons}
      </div>
    </div>
    
    <div class="card-progress">
      <div class="card-progress-item">
        <div class="card-progress-label">
          <span><i class="fas fa-check-circle"></i> Lessons</span>
          <span>${lessonsProgress}%</span>
        </div>
        <div class="progress-bar">
          <div class="progress-fill lessons" style="width: ${lessonsProgress}%"></div>
        </div>
      </div>
      
      <div class="card-progress-item">
        <div class="card-progress-label">
          <span><i class="fas fa-file-alt"></i> Assignments</span>
          <span>${assignmentsProgress}%</span>
        </div>
        <div class="progress-bar">
          <div class="progress-fill assignments" style="width: ${assignmentsProgress}%"></div>
        </div>
      </div>
      
      <div class="card-overall-progress">
        <div class="card-progress-label">
          <span>Overall Progress</span>
          <span>${overallProgress}%</span>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" style="width: ${overallProgress}%"></div>
        </div>
      </div>
    </div>
    
    <div class="card-stats">
      <div class="stat">
        <div class="stat-value">${module.lessons.length}</div>
        <div class="stat-label">Lessons</div>
      </div>
      <div class="stat">
        <div class="stat-value">${module.lessons.filter(l => l.completed).length}</div>
        <div class="stat-label">Completed</div>
      </div>
      <div class="stat">
        <div class="stat-value">${module.assignments.length}</div>
        <div class="stat-label">Assignments</div>
      </div>
    </div>
  `;
  
  return cardElement;
}

// Create detailed module element (for detailed view)
function createDetailedModuleElement(module) {
  const lessonsProgress = calculateProgress(module.lessons);
  const assignmentsProgress = calculateProgress(module.assignments);
  const overallProgress = Math.round((lessonsProgress + assignmentsProgress) / 2);
  
  // Calculate circumference for circular progress (2 * π * r, r = 45)
  const circumference = 2 * Math.PI * 45;
  const lessonsOffset = circumference - (lessonsProgress / 100) * circumference;
  const assignmentsOffset = circumference - (assignmentsProgress / 100) * circumference;
  const overallOffset = circumference - (overallProgress / 100) * circumference;
  
  // Determine which buttons to show in detailed view
  let detailedActionButtons = '';
  if (module.completed) {
    detailedActionButtons = `
      <button class="icon-btn retry-btn" onclick="toggleModuleCompletion(${module.id})" title="Retry this module">
        <i class="fas fa-redo"></i>
      </button>
      <button class="icon-btn" onclick="deleteModule(${module.id})" title="Delete module">
        <i class="fas fa-trash"></i>
      </button>
    `;
  } else {
    detailedActionButtons = `
      <button class="icon-btn" onclick="startEditModuleName(${module.id}, '${module.name.replace(/'/g, "\\'")}')" title="Edit module name">
        <i class="fas fa-edit"></i>
      </button>
      <button class="icon-btn" onclick="toggleModuleCompletion(${module.id})" title="Mark as complete">
        <i class="fas fa-check"></i>
      </button>
      <button class="icon-btn" onclick="deleteModule(${module.id})" title="Delete module">
        <i class="fas fa-trash"></i>
      </button>
    `;
  }
  
  return `
    <div class="module-detailed ${module.completed ? 'completed' : ''}">
      <div class="detailed-header">
        <div class="detailed-title">
          <i class="fas fa-book"></i>
          <div class="detailed-title-text" ondblclick="startEditModuleName(${module.id}, '${module.name.replace(/'/g, "\\'")}')">${module.name}</div>
        </div>
        <div class="detailed-actions">
          ${detailedActionButtons}
        </div>
      </div>
      
      <div class="detailed-progress-section">
        <div class="progress-chart">
          <h3 class="chart-title"><i class="fas fa-check-circle"></i> Lessons Progress</h3>
          <div class="circular-progress">
            <svg width="200" height="200" viewBox="0 0 100 100">
              <defs>
                <linearGradient id="lessons-gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                  <stop offset="0%" style="stop-color:#10b981;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#34d399;stop-opacity:1" />
                </linearGradient>
              </defs>
              <circle class="circle-bg" cx="50" cy="50" r="45"></circle>
              <circle class="circle-progress lessons-circle" cx="50" cy="50" r="45" 
                stroke-dasharray="${circumference}" 
                stroke-dashoffset="${lessonsOffset}"></circle>
            </svg>
            <div class="progress-percentage">${lessonsProgress}%</div>
          </div>
          <div class="progress-label-large">${module.lessons.filter(l => l.completed).length} of ${module.lessons.length} lessons completed</div>
        </div>
        
        <div class="progress-chart">
          <h3 class="chart-title"><i class="fas fa-file-alt"></i> Assignments Progress</h3>
          <div class="circular-progress">
            <svg width="200" height="200" viewBox="0 0 100 100">
              <defs>
                <linearGradient id="assignments-gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                  <stop offset="0%" style="stop-color:#f59e0b;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#fbbf24;stop-opacity:1" />
                </linearGradient>
              </defs>
              <circle class="circle-bg" cx="50" cy="50" r="45"></circle>
              <circle class="circle-progress assignments-circle" cx="50" cy="50" r="45" 
                stroke-dasharray="${circumference}" 
                stroke-dashoffset="${assignmentsOffset}"></circle>
            </svg>
            <div class="progress-percentage">${assignmentsProgress}%</div>
          </div>
          <div class="progress-label-large">${module.assignments.filter(a => a.completed).length} of ${module.assignments.length} assignments completed</div>
        </div>
        
        <div class="progress-chart">
          <h3 class="chart-title"><i class="fas fa-chart-line"></i> Overall Progress</h3>
          <div class="circular-progress">
            <svg width="200" height="200" viewBox="0 0 100 100">
              <defs>
                <linearGradient id="overall-gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                  <stop offset="0%" style="stop-color:#6366f1;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#06b6d4;stop-opacity:1" />
                </linearGradient>
              </defs>
              <circle class="circle-bg" cx="50" cy="50" r="45"></circle>
              <circle class="circle-progress overall-circle" cx="50" cy="50" r="45" 
                stroke-dasharray="${circumference}" 
                stroke-dashoffset="${overallOffset}"></circle>
            </svg>
            <div class="progress-percentage">${overallProgress}%</div>
          </div>
          <div class="progress-label-large">Module Completion</div>
        </div>
      </div>
      
      <div class="items-section">
        <div class="section-box">
          <h3 class="section-title"><i class="fas fa-check-circle"></i> Lessons</h3>
          <div class="add-item">
            <input type="text" id="detailed-lesson-input-${module.id}" placeholder="Add a new lesson">
            <button onclick="addLesson(${module.id})">Add</button>
          </div>
          <ul class="item-list" id="detailed-lessons-list-${module.id}">
            ${module.lessons.map(lesson => `
              <li class="lesson-item ${lesson.completed ? 'completed' : ''}" data-id="${lesson.id}">
                <div class="item-info">
                  <div class="checkbox ${lesson.completed ? 'checked' : ''}" onclick="toggleLesson(${module.id}, ${lesson.id})"></div>
                  <div class="item-text" ondblclick="startEditItemName(${module.id}, 'lesson', ${lesson.id}, '${lesson.text.replace(/'/g, "\\'")}')">
                    <div class="item-text-content">${lesson.text}</div>
                  </div>
                </div>
                <div class="item-actions">
                  <button class="edit-btn" onclick="startEditItemName(${module.id}, 'lesson', ${lesson.id}, '${lesson.text.replace(/'/g, "\\'")}')" title="Edit lesson">
                    <i class="fas fa-edit"></i>
                  </button>
                  <button class="delete-btn" onclick="deleteLesson(${module.id}, ${lesson.id})" title="Delete lesson">
                    <i class="fas fa-times"></i>
                  </button>
                </div>
              </li>
            `).join('')}
          </ul>
        </div>
        
        <div class="section-box">
          <h3 class="section-title"><i class="fas fa-file-alt"></i> Assignments</h3>
          <div class="add-item">
            <input type="text" id="detailed-assignment-input-${module.id}" placeholder="Add a new assignment">
            <button onclick="addAssignment(${module.id})">Add</button>
          </div>
          <ul class="item-list" id="detailed-assignments-list-${module.id}">
            ${module.assignments.map(assignment => `
              <li class="assignment-item ${assignment.completed ? 'completed' : ''}" data-id="${assignment.id}">
                <div class="item-info">
                  <div class="checkbox ${assignment.completed ? 'checked' : ''}" onclick="toggleAssignment(${module.id}, ${assignment.id})"></div>
                  <div class="item-text" ondblclick="startEditItemName(${module.id}, 'assignment', ${assignment.id}, '${assignment.text.replace(/'/g, "\\'")}')">
                    <div class="item-text-content">${assignment.text}</div>
                  </div>
                </div>
                <div class="item-actions">
                  <button class="edit-btn" onclick="startEditItemName(${module.id}, 'assignment', ${assignment.id}, '${assignment.text.replace(/'/g, "\\'")}')" title="Edit assignment">
                    <i class="fas fa-edit"></i>
                  </button>
                  <button class="delete-btn" onclick="deleteAssignment(${module.id}, ${assignment.id})" title="Delete assignment">
                    <i class="fas fa-times"></i>
                  </button>
                </div>
              </li>
            `).join('')}
          </ul>
        </div>
      </div>
    </div>
  `;
}

// Show detailed view for a module
function showDetailedView(moduleId) {
  const module = modules.find(m => m.id === moduleId);
  if (!module) return;
  
  currentModuleId = moduleId;
  currentView = 'detailed';
  
  const cardView = document.getElementById('card-view');
  const detailedView = document.getElementById('detailed-view');
  const moduleDetailedContainer = document.getElementById('module-detailed-container');
  
  cardView.style.display = 'none';
  detailedView.style.display = 'block';
  
  moduleDetailedContainer.innerHTML = createDetailedModuleElement(module);
  
  // Update circular progress animations
  updateCircularProgress(module);
}

// Start editing module name
function startEditModuleName(moduleId, currentName) {
  editingModuleId = moduleId;
  document.getElementById('edit-module-name').value = currentName;
  document.getElementById('edit-module-modal').classList.add('active');
}

// Save module name
function saveModuleName() {
  const newName = document.getElementById('edit-module-name').value.trim();
  if (!newName) return;
  
  const module = modules.find(m => m.id === editingModuleId);
  if (module) {
    module.name = newName;
    saveData();
    
    if (currentView === 'detailed' && currentModuleId === editingModuleId) {
      showDetailedView(editingModuleId);
    } else {
      renderCardView();
    }
    
    hideEditModuleModal();
  }
}

// Start editing item name
function startEditItemName(moduleId, type, itemId, currentText) {
  editingItem = { moduleId, type, id: itemId };
  document.getElementById('edit-item-name').value = currentText;
  document.getElementById('edit-item-type').value = type;
  document.getElementById('edit-item-id').value = itemId;
  document.getElementById('edit-item-modal').classList.add('active');
}

// Save item name
function saveItemName() {
  const newName = document.getElementById('edit-item-name').value.trim();
  const type = document.getElementById('edit-item-type').value;
  const itemId = parseInt(document.getElementById('edit-item-id').value);
  
  if (!newName) return;
  
  const module = modules.find(m => m.id === editingItem.moduleId);
  if (module) {
    const items = type === 'lesson' ? module.lessons : module.assignments;
    const item = items.find(i => i.id === itemId);
    if (item) {
      item.text = newName;
      saveData();
      
      if (currentView === 'detailed' && currentModuleId === editingItem.moduleId) {
        showDetailedView(editingItem.moduleId);
      } else {
        renderCardView();
      }
      
      hideEditItemModal();
    }
  }
}

// Hide edit modals
function hideEditModuleModal() {
  document.getElementById('edit-module-modal').classList.remove('active');
  editingModuleId = null;
}

function hideEditItemModal() {
  document.getElementById('edit-item-modal').classList.remove('active');
  editingItem = { type: null, id: null, moduleId: null };
}

// Update circular progress animations
function updateCircularProgress(module) {
  setTimeout(() => {
    const lessonsProgress = calculateProgress(module.lessons);
    const assignmentsProgress = calculateProgress(module.assignments);
    const overallProgress = Math.round((lessonsProgress + assignmentsProgress) / 2);
    
    // Update the circular progress bars in the detailed view
    const circumference = 2 * Math.PI * 45;
    const lessonsOffset = circumference - (lessonsProgress / 100) * circumference;
    const assignmentsOffset = circumference - (assignmentsProgress / 100) * circumference;
    const overallOffset = circumference - (overallProgress / 100) * circumference;
    
    const lessonCircle = document.querySelector('.lessons-circle');
    const assignmentCircle = document.querySelector('.assignments-circle');
    const overallCircle = document.querySelector('.overall-circle');
    
    if (lessonCircle) {
      lessonCircle.style.strokeDashoffset = lessonsOffset;
    }
    if (assignmentCircle) {
      assignmentCircle.style.strokeDashoffset = assignmentsOffset;
    }
    if (overallCircle) {
      overallCircle.style.strokeDashoffset = overallOffset;
    }
  }, 100);
}

// Show card view
function showCardView() {
  renderCardView();
  updateStats();
}

// Calculate progress percentage
function calculateProgress(items) {
  if (items.length === 0) return 0;
  const completed = items.filter(item => item.completed).length;
  return Math.round((completed / items.length) * 100);
}

// Update statistics
function updateStats() {
  const totalModules = modules.length;
  const completedModules = modules.filter(m => m.completed).length;
  const totalLessons = modules.reduce((sum, module) => sum + module.lessons.length, 0);
  const completedAssignments = modules.reduce((sum, module) => {
    return sum + module.assignments.filter(assignment => assignment.completed).length;
  }, 0);
  
  document.getElementById('total-modules').textContent = totalModules;
  document.getElementById('completed-modules').textContent = completedModules;
  document.getElementById('total-lessons').textContent = totalLessons;
  document.getElementById('completed-assignments').textContent = completedAssignments;
}

// Add a new module
function addNewModule() {
  const moduleName = document.getElementById('new-module-name').value.trim();
  
  if (!moduleName) {
    alert('Please enter a module name');
    return;
  }
  
  const newModule = {
    id: nextId++,
    name: moduleName,
    completed: false,
    lessons: [],
    assignments: []
  };
  
  modules.push(newModule);
  saveData();
  
  if (currentView === 'card') {
    renderCardView();
  }
  
  updateStats();
  hideAddModuleModal();
  
  // Clear input
  document.getElementById('new-module-name').value = '';
}

// Show add module modal
function showAddModuleModal() {
  document.getElementById('add-module-modal').classList.add('active');
}

// Hide add module modal
function hideAddModuleModal() {
  document.getElementById('add-module-modal').classList.remove('active');
}

// Toggle module completion
function toggleModuleCompletion(moduleId, event = null) {
  if (event) event.stopPropagation();
  
  const module = modules.find(m => m.id === moduleId);
  if (module) {
    module.completed = !module.completed;
    saveData();
    
    if (currentView === 'card') {
      renderCardView();
    } else if (currentView === 'detailed' && currentModuleId === moduleId) {
      showDetailedView(moduleId);
    }
    
    updateStats();
  }
}

// Delete a module
function deleteModule(moduleId, event = null) {
  if (event) event.stopPropagation();
  
  if (!confirm('Are you sure you want to delete this module? This action cannot be undone.')) {
    return;
  }
  
  modules = modules.filter(m => m.id !== moduleId);
  saveData();
  
  if (currentView === 'detailed' && currentModuleId === moduleId) {
    showCardView();
  } else {
    renderCardView();
  }
  
  updateStats();
}

// Add a lesson
function addLesson(moduleId) {
  const input = currentView === 'detailed' 
    ? document.getElementById(`detailed-lesson-input-${moduleId}`)
    : document.getElementById(`lesson-input-${moduleId}`);
    
  const lessonText = input.value.trim();
  
  if (!lessonText) return;
  
  const module = modules.find(m => m.id === moduleId);
  if (module) {
    const lessonId = module.lessons.length > 0 ? Math.max(...module.lessons.map(l => l.id)) + 1 : 1;
    module.lessons.push({
      id: lessonId,
      text: lessonText,
      completed: false
    });
    
    saveData();
    
    if (currentView === 'detailed' && currentModuleId === moduleId) {
      showDetailedView(moduleId);
    } else {
      renderCardView();
    }
    
    updateStats();
    input.value = '';
  }
}

// Toggle lesson completion
function toggleLesson(moduleId, lessonId) {
  const module = modules.find(m => m.id === moduleId);
  if (module) {
    const lesson = module.lessons.find(l => l.id === lessonId);
    if (lesson) {
      lesson.completed = !lesson.completed;
      saveData();
      
      if (currentView === 'detailed' && currentModuleId === moduleId) {
        showDetailedView(moduleId);
      } else {
        renderCardView();
      }
      
      updateStats();
    }
  }
}

// Delete a lesson
function deleteLesson(moduleId, lessonId) {
  const module = modules.find(m => m.id === moduleId);
  if (module) {
    module.lessons = module.lessons.filter(l => l.id !== lessonId);
    saveData();
    
    if (currentView === 'detailed' && currentModuleId === moduleId) {
      showDetailedView(moduleId);
    } else {
      renderCardView();
    }
    
    updateStats();
  }
}

// Add an assignment
function addAssignment(moduleId) {
  const input = currentView === 'detailed'
    ? document.getElementById(`detailed-assignment-input-${moduleId}`)
    : document.getElementById(`assignment-input-${moduleId}`);
    
  const assignmentText = input.value.trim();
  
  if (!assignmentText) return;
  
  const module = modules.find(m => m.id === moduleId);
  if (module) {
    const assignmentId = module.assignments.length > 0 ? Math.max(...module.assignments.map(a => a.id)) + 1 : 1;
    module.assignments.push({
      id: assignmentId,
      text: assignmentText,
      completed: false
    });
    
    saveData();
    
    if (currentView === 'detailed' && currentModuleId === moduleId) {
      showDetailedView(moduleId);
    } else {
      renderCardView();
    }
    
    updateStats();
    input.value = '';
  }
}

// Toggle assignment completion
function toggleAssignment(moduleId, assignmentId) {
  const module = modules.find(m => m.id === moduleId);
  if (module) {
    const assignment = module.assignments.find(a => a.id === assignmentId);
    if (assignment) {
      assignment.completed = !assignment.completed;
      saveData();
      
      if (currentView === 'detailed' && currentModuleId === moduleId) {
        showDetailedView(moduleId);
      } else {
        renderCardView();
      }
      
      updateStats();
    }
  }
}

// Delete an assignment
function deleteAssignment(moduleId, assignmentId) {
  const module = modules.find(m => m.id === moduleId);
  if (module) {
    module.assignments = module.assignments.filter(a => a.id !== assignmentId);
    saveData();
    
    if (currentView === 'detailed' && currentModuleId === moduleId) {
      showDetailedView(moduleId);
    } else {
      renderCardView();
    }
    
    updateStats();
  }
}

// Save data to localStorage
function saveData() {
  localStorage.setItem('university-modules', JSON.stringify(modules));
}

// Clear all data
function clearAllData() {
  if (confirm('Are you sure you want to clear all data? This action cannot be undone.')) {
    modules = [];
    nextId = 1;
    saveData();
    renderCardView();
    updateStats();
  }
}

// Export data as JSON file
function exportData() {
  const dataStr = JSON.stringify(modules, null, 2);
  const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
  
  const exportFileDefaultName = 'university-progress-data.json';
  
  const linkElement = document.createElement('a');
  linkElement.setAttribute('href', dataUri);
  linkElement.setAttribute('download', exportFileDefaultName);
  linkElement.click();
}

// Initialize the app when page loads
document.addEventListener('DOMContentLoaded', initApp);

// Close modal when clicking outside
document.addEventListener('click', (e) => {
  const modals = ['add-module-modal', 'edit-module-modal', 'edit-item-modal'];
  modals.forEach(modalId => {
    const modal = document.getElementById(modalId);
    if (e.target === modal) {
      modal.classList.remove('active');
      if (modalId === 'edit-module-modal') editingModuleId = null;
      if (modalId === 'edit-item-modal') editingItem = { type: null, id: null, moduleId: null };
    }
  });
});

// Keyboard shortcuts
document.addEventListener('keydown', (e) => {
  // Ctrl/Cmd + N to add new module
  if ((e.ctrlKey || e.metaKey) && e.key === 'n') {
    e.preventDefault();
    showAddModuleModal();
  }
  
  // Escape to close modal or go back
  if (e.key === 'Escape') {
    document.getElementById('add-module-modal').classList.remove('active');
    document.getElementById('edit-module-modal').classList.remove('active');
    document.getElementById('edit-item-modal').classList.remove('active');
    if (currentView === 'detailed') {
      showCardView();
    }
  }
});
</script>
</body>
</html>